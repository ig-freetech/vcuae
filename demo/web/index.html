<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#06162c" />
    <title>Transaction Ledger</title>
    <link rel="manifest" href="./manifest.webmanifest" />
    <link rel="icon" href="./icons/icon.svg" type="image/svg+xml" />
    <link rel="apple-touch-icon" href="./icons/apple-touch-icon.png" />
    <link rel="stylesheet" href="./styles.css" />
    <script src="../shared/ledger-core.js" defer></script>
    <script src="./app.js" defer></script>
  </head>
  <body>
    <main class="shell">
      <header class="hero">
        <p class="hero-kicker">Transaction Ledger</p>
        <h1>Value Creation UAE</h1>
      </header>

      <div id="config-banner" class="config-banner hidden">
        <span>&#9881;</span>
        <span>Connection not configured. Contact your administrator.</span>
      </div>

      <section class="card workflow-card">
        <nav class="stepper" aria-label="Input steps">
          <button id="step-customer" class="step active" type="button">
            1. Customer Info
          </button>
          <button id="step-staff" class="step" type="button" disabled>
            2. Staff Review
          </button>
        </nav>

        <form id="ledger-form" novalidate>
          <section id="pane-customer" class="pane active">
            <h2>Customer Input</h2>
            <div class="grid two-col">
              <label>
                <span>Customer Name</span>
                <input name="customerName" required autocomplete="name" />
              </label>
              <label>
                <span>Gender</span>
                <select id="gender" name="gender" required></select>
              </label>
              <label>
                <span>Birthday</span>
                <input name="birthday" type="date" required />
              </label>
              <label>
                <span>Mobile Number</span>
                <input
                  name="mobileNumber"
                  type="tel"
                  inputmode="tel"
                  required
                  autocomplete="tel"
                />
              </label>
              <label>
                <span>Email (optional)</span>
                <input name="email" type="email" autocomplete="email" />
              </label>
              <label>
                <span>Country</span>
                <select id="country" name="country" required></select>
              </label>
              <label>
                <span>How did you hear about us?</span>
                <select id="ref-select">
                  <option value="" disabled selected>-- Select --</option>
                  <option>Google Search</option>
                  <option>Website</option>
                  <option>Facebook</option>
                  <option>Instagram</option>
                  <option value="Other">Other</option>
                </select>
                <input
                  id="ref-other"
                  class="hidden"
                  placeholder="Please specify"
                />
                <input type="hidden" name="ref" id="ref-value" />
              </label>
              <label>
                <span>Payment Method</span>
                <select id="payment-select" required>
                  <option value="" disabled selected>-- Select --</option>
                  <option>Cash</option>
                  <option>Card</option>
                  <option>Bank Transfer</option>
                  <option>Tabby</option>
                  <option value="Other">Other</option>
                </select>
                <input
                  id="payment-other"
                  class="hidden"
                  placeholder="Please specify"
                />
                <input type="hidden" name="paymentMethod" id="payment-value" />
              </label>
              <label class="full">
                <span>Address</span>
                <textarea
                  name="address"
                  rows="2"
                  required
                  autocomplete="street-address"
                ></textarea>
              </label>
            </div>
            <section class="consent-block">
              <h3>Conditions</h3>
              <label class="consent-item">
                <input type="checkbox" name="consent1" required />
                <span
                  >If an item is found to be stolen or counterfeit after purchase, we will immediately
                  notify the police and hand over the item, and legal action will be taken in
                  accordance with the laws of the United Arab Emirates.</span
                >
              </label>
              <label class="consent-item">
                <input type="checkbox" name="consent2" required />
                <span
                  >If items do not meet our quality standards during the authentication process, the
                  initial quotation given over the phone will be revised or the item will be rejected
                  and returned as per the company policy.</span
                >
              </label>
              <label class="consent-item consent-item-highlight">
                <input type="checkbox" name="consent3" required />
                <span
                  >If the authenticity of the item(s) are found to be Fake, Counterfeit or Undetermined
                  by the 3rd party authentication systems used by the company, the customer is
                  responsible to pay a fee of AED 250 per item to the company by cash or card at the
                  point of collecting the item back after inspection. Items will be inspected through
                  LegitGrails and/or Entrupy and will be presented to the customer.</span
                >
              </label>
              <label class="consent-item">
                <input type="checkbox" name="consent4" required />
                <span
                  >By signing this document, the customer confirms that they are the rightful owner of
                  the items and that the company has paid the total amount as per the final agreed
                  estimate and has purchased the items in good faith. By doing so, the customer
                  acknowledges that ownership of the items is transferred to the company. The customer
                  also acknowledges that they have fully read and understood the company's terms and
                  conditions at the time of sale.</span
                >
              </label>
            </section>
            <div class="actions">
              <button id="next-btn" type="button">Next: Staff Review</button>
            </div>
          </section>

          <section id="pane-staff" class="pane">
            <h2>Staff Input</h2>
            <div class="grid two-col">
              <label>
                <span>Visit Date</span>
                <input name="visitDate" type="date" required />
              </label>
              <label>
                <span>Category</span>
                <select id="cs-category" name="csCategory" required></select>
              </label>
              <label>
                <span>Buy Total (AED)</span>
                <input
                  name="totalPurchase"
                  type="text"
                  inputmode="decimal"
                  placeholder="e.g. 1200"
                />
              </label>
              <label>
                <span>Sales Total (AED)</span>
                <input
                  name="grandTotal"
                  type="text"
                  inputmode="decimal"
                  placeholder="e.g. 1200"
                />
              </label>
              <div class="derived full">
                <p>Age: <strong id="derived-age">-</strong></p>
                <p>Birth Month: <strong id="derived-month">-</strong></p>
                <p>Country (JP): <strong id="derived-country-jp">-</strong></p>
                <p>Continent: <strong id="derived-continent">-</strong></p>
                <p>Subregion: <strong id="derived-subregion">-</strong></p>
              </div>
              <section class="photo-capture full">
                <h3>Certificate Photo</h3>
                <p class="photo-help">
                  Take a photo and review the preview. The photo will be uploaded to Google Drive
                  when you submit.
                </p>
                <input
                  id="certificate-photo-input"
                  type="file"
                  accept="image/*"
                  capture="environment"
                  class="hidden"
                />
                <input id="certificate-photo-url" name="certificatePhotoUrl" type="hidden" />
                <div class="photo-actions">
                  <button id="capture-photo-btn" type="button" class="secondary">
                    Take Certificate Photo
                  </button>
                  <button id="retake-photo-btn" type="button" class="secondary hidden">Retake</button>
                </div>
                <figure id="photo-preview-wrap" class="photo-preview-wrap hidden">
                  <img id="certificate-photo-preview" class="photo-preview" alt="Certificate preview" />
                </figure>
                <p id="photo-saved-wrap" class="photo-saved-wrap hidden">
                  Saved: <a id="photo-saved-link" href="#" target="_blank" rel="noopener">Open file</a>
                </p>
                <output id="photo-status" class="status" aria-live="polite"></output>
              </section>
            </div>
            <div class="actions split">
              <button id="back-btn" type="button" class="secondary">
                Back
              </button>
              <button id="submit-btn" type="submit" disabled>Submit</button>
            </div>
          </section>
        </form>

        <div id="success-overlay" class="success-overlay hidden">
          <div class="success-overlay-content">
            <div class="success-checkmark">&#10003;</div>
            <h2 class="success-title">Successful</h2>
            <button id="new-entry-btn" type="button" class="success-new-entry-btn">New Entry</button>
          </div>
        </div>

        <output id="status" class="status" aria-live="polite"></output>
      </section>
    </main>
  </body>
</html>
